<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mauro Loprete">

<title>metaSurvey</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Appendices/AppendixA.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">index.html</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">metaSurvey</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/metaSurveyR" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./metaSurvey.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">index.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendices/AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Soy un apaendice</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-Chapter1" id="toc-sec-Chapter1" class="nav-link active" data-scroll-target="#sec-Chapter1"><span class="header-section-number">1</span> Introducción</a>
  <ul class="collapse">
  <li><a href="#motivación" id="toc-motivación" class="nav-link" data-scroll-target="#motivación"><span class="header-section-number">1.1</span> Motivación</a></li>
  <li><a href="#mercado-de-trabajo-ech-vs-metasurvey" id="toc-mercado-de-trabajo-ech-vs-metasurvey" class="nav-link" data-scroll-target="#mercado-de-trabajo-ech-vs-metasurvey"><span class="header-section-number">1.2</span> Mercado de Trabajo {ech} vs {metaSurvey}</a></li>
  </ul></li>
  <li><a href="#sec-Chapter2" id="toc-sec-Chapter2" class="nav-link" data-scroll-target="#sec-Chapter2"><span class="header-section-number">2</span> Metaprogramación</a>
  <ul class="collapse">
  <li><a href="#principios-básicos" id="toc-principios-básicos" class="nav-link" data-scroll-target="#principios-básicos"><span class="header-section-number">2.1</span> Principios básicos</a>
  <ul class="collapse">
  <li><a href="#el-código-cmo-datos" id="toc-el-código-cmo-datos" class="nav-link" data-scroll-target="#el-código-cmo-datos"><span class="header-section-number">2.1.1</span> El código cmo datos</a></li>
  <li><a href="#el-código-como-expresiones" id="toc-el-código-como-expresiones" class="nav-link" data-scroll-target="#el-código-como-expresiones"><span class="header-section-number">2.1.2</span> El código como expresiones</a></li>
  <li><a href="#el-código-puede-generar-código" id="toc-el-código-puede-generar-código" class="nav-link" data-scroll-target="#el-código-puede-generar-código"><span class="header-section-number">2.1.3</span> El código puede generar código</a></li>
  <li><a href="#el-código-puede-ser-evaluado" id="toc-el-código-puede-ser-evaluado" class="nav-link" data-scroll-target="#el-código-puede-ser-evaluado"><span class="header-section-number">2.1.4</span> El código puede ser evaluado</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-Chapter3" id="toc-sec-Chapter3" class="nav-link" data-scroll-target="#sec-Chapter3"><span class="header-section-number">3</span> Muestreo</a></li>
  <li><a href="#sec-Chapter3" id="toc-sec-Chapter3" class="nav-link" data-scroll-target="#sec-Chapter3"><span class="header-section-number">4</span> Metodología de varianzas</a></li>
  <li><a href="#sec-Chapter4" id="toc-sec-Chapter4" class="nav-link" data-scroll-target="#sec-Chapter4"><span class="header-section-number">5</span> Desarollo del paquete</a></li>
  <li><a href="#sec-Chapter4" id="toc-sec-Chapter4" class="nav-link" data-scroll-target="#sec-Chapter4"><span class="header-section-number">6</span> Infraestructura</a></li>
  <li><a href="#sec-Chapter5" id="toc-sec-Chapter5" class="nav-link" data-scroll-target="#sec-Chapter5"><span class="header-section-number">7</span> Aplicación</a></li>
  <li><a href="#sec-Chapter5" id="toc-sec-Chapter5" class="nav-link" data-scroll-target="#sec-Chapter5"><span class="header-section-number">8</span> Conclusiones y trabajo a futuro</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/metaSurveyR/edit/main/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/metaSurveyR/blob/main/index.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/metaSurveyR/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">metaSurvey</h1>
<p class="subtitle lead">Paquete de R para el procesamiento de encuestas por muestreo con generación de recetas mediante metaprogramación y estimación de varianzas.</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="http://www.janedoe.com">Mauro Loprete</a> </p>
          </div>
  </div>
    
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    El trabajo presenta metaSurvey, un paquete de R diseñado para mejorar el procesamiento de encuestas por muestreo y la estimación de parámetros poblacionales. Utiliza metaprogramación y técnicas de remuestreo para ofrecer resultados precisos, evaluar la incertidumbre y fomentar la reproducibilidad. A diferencia de otras bibliotecas, metaSurvey combina flexibilidad mediante metaprogramación con las capacidades de procesamiento de encuestas del paquete survey. Los objetivos incluyen proporcionar una herramienta útil, incorporar técnicas de remuestreo para usuarios no expertos, permitir la generación de ‘recetas’ personalizadas, y fomentar la contribución de la comunidad. Se destaca como alternativa a paquetes propietarios, enfocándose en la transparencia y reproducibilidad para mejorar la confiabilidad de las estimaciones poblacionales.
  </div>
</div>

</header>

<section id="sec-Chapter1" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>En este documento se presenta el desarollo del paquete metaSurvey disponible en R. El objetivo principal de metaSurvey es permitir que el usuario pueda construir indicadores de manera reproducible y transparente, teniendo el usuario un control total sobre el proceso de transformación de los microdatos a indicadores.</p>
<p>A lo largo del documento se mencionan diferentes conceptos para el desarrollo del paquete, como la meta-programación, conceptos de Inferencia en Poblaciones finitas, metodología sobre el desarrollo de paquetes en R. Además, se presentan ejemplos de cómo utilizar el paquete metaSurvey para construir indicadores de mercado de trabajo a partir de los microdatos de la Encuesta Continua de Hogares del Instituto Nacional de Estadística de Uruguay.</p>
<p>La motivación principal del desarrollo del paquete fue la necesidad de contar con un paquete que permita al usuario tener un control total sobre el proceso de transformación de los microdatos a indicadores. En general, los paquetes que existen en R para el análisis de encuestas por muestreo son muy sensibles a la estructura y las variables que componen a la encuesta. En general, un cambio en la estructura de la encuesta implica una nueva versión del paquete utilizado para obtener los indicadores, siendo poco flexible a cambios en la estructura de la encuesta y generalmente el usuario tiene una función de alto nivel que no permite modificar el código para adaptarlo a sus necesidades o saber cada paso que se realiza para obtener el indicador sin tener que leer el código fuente o la documentación adjunta.</p>
<p>El problema de sensibilidad a la estructura de la encuesta puede verse en el paquete ech <span class="citation" data-cites="ech">(<a href="#ref-ech" role="doc-biblioref">Mathieu &amp; Detomasi, 2020</a>)</span> donde en el existen funciones para crear variables de mercado de trabajo, pero estas funciones dependen de una va</p>
<p>Dentro del documento se presentan ejemplos de cómo utilizar el paquete metaSurvey para construir indicadores de mercado de trabajo a partir de los microdatos de la Encuesta Continua de Hogares del Instituto Nacional de Estadística de Uruguay.</p>
<p>Además, se presentan conceptos claves de la meta-programación y se muestra cómo se utiliza la meta-programación en el paquete metaSurvey. Luego se presentan conceptos básicos de muestreo sobre los estimadores bajo el contexto de Inferencia en Poblaciones finitas, para luego mostrar cómo es crucial tener en cuenta el diseño de la encuesta para la construcción de indicadores y evaluar su incertidumbre, otro de los puntos fuertes del paquete metaSurvey. Por último, se muestra una aplicación del uso cotidiano del paquete, donde pueden verse ejemplos de cómo construir nuestras propias recetas y/o también consultar recetas ya construidas por otros usuarios.</p>
<section id="motivación" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="motivación"><span class="header-section-number">1.1</span> Motivación</h2>
<p>La fuente principal de los indicadores sociales y económicos a nivel poblacional proviene, en general, de encuestas por muestreo. Construir un indicador de interés a partir de los microdatos de una encuesta implica un proceso de creación de variables que intentan capturar el fenómeno de interés. En general, el proceso de construcción de indicadores es complejo e involucra la selección de variables, la creación de variables sintéticas, la imputación de valores faltantes, la estandarización de variables, la selección de la unidad de análisis, entre otros.</p>
<p>Este proceso es crucial para la correcta interpretación de los resultados y para la comparabilidad de los indicadores a través del tiempo y entre diferentes poblaciones. En este sentido, la construcción de indicadores requiere un conocimiento profundo de la encuesta y de las variables que la componen, así como de las características de la población de interés.</p>
<p>En general, este proceso se realiza en algún software estadístico, como SPSS, SAS o STATA. Sin embargo, en los últimos años, el uso de R para el análisis de datos ha crecido significativamente. R es un lenguaje de programación y un entorno de desarrollo para la realización de análisis estadísticos. R es un software libre, lo que significa que es gratuito y actualmente posee una comunidad de usuarios muy activa que desarrolla paquetes y funciones para realizar análisis y modelos estadísticos.</p>
<p>En R, existen diferentes paquetes para procesar encuestas por muestreo. El paquete más conocido es survey, que permite realizar análisis de encuestas por muestreo de manera sencilla y eficiente. El paquete survey permite realizar análisis descriptivos, estimar diferentes indicadores tomando en cuenta el diseño de la encuesta y los estadísticos más usuales. Además, el paquete survey permite realizar análisis de encuestas complejas, como encuestas con estratificación, conglomerados y diseño de muestreo complejo.</p>
<p>Dentro de la comunidad de R también existen otros paquetes que se centran en alguna encuesta en particular, como el paquete ech, que permite obtener datos de la Encuesta Continua de Hogares del Instituto Nacional de Estadística de Uruguay, o el paquete eph, que permite obtener datos de la Encuesta Permanente de Hogares del Instituto Nacional de Estadística y Censos de Argentina, entre otros.</p>
<p>Estos paquetes permiten democratizar el acceso a los microdatos y obtener los indicadores de interés utilizando R con funciones comprensibles para cualquier usuario con experiencia en análisis de datos. Esto es importante ya que permite que los usuarios puedan replicar los resultados y verificar la calidad de los indicadores. Además, fomenta la transparencia y la reproducibilidad de los resultados, ya que los usuarios pueden compartir el código y los datos utilizados para obtener los indicadores.</p>
<p>Sin embargo, una de las limitaciones de estos paquetes es que son muy sensibles a la estructura y las variables que componen a la encuesta. En general, un cambio en la estructura de la encuesta implica un cambio en el código utilizado para obtener los indicadores, siendo poco flexible a cambios en la estructura de la encuesta y generalmente el usuario tiene una función de alto nivel que no permite modificar el código para adaptarlo a sus necesidades o saber cada paso que se realiza para obtener el indicador sin tener que leer el código fuente o la documentación adjunta.</p>
<p>En este sentido, metaSurvey es un paquete que busca solucionar estas limitaciones ya que todo el proceso de transformación de los microdatos a indicadores se realiza a través de una serie de funciones que permiten al usuario tener un control total y transparente sobre el proceso de transformación de los microdatos a indicadores. Además, metaSurvey permite que el usuario pueda realizar el proceso de transformación de los microdatos a indicadores de manera reproducible y transparente, ya que el usuario puede compartir el código y los datos utilizados para obtener los indicadores, mediante lo que denominamos steps y recipes, conformando así una especie de “recetario de cocina” para la construcción de indicadores.</p>
<p>El enfoque que permite la flexibilidad a la hora de construir los indicadores es la meta-programación. La meta-programación es un paradigma de programación que permite que un programa pueda modificar su estructura interna. En R, la meta-programación se realiza a través de las funciones eval y parse que permiten evaluar y parsear código de manera dinámica. En este sentido, metaSurvey utiliza la meta-programación para permitir que el usuario pueda modificar el código que se utiliza para transformar los microdatos a indicadores teniendo funciones similares a las que se utilizan en el paquete recipes de la librería tidymodels.</p>
<p>En lo que sigue de esta sección, se presenta el paquete metaSurvey y se muestran ejemplos para la construcción y estimación de variables de mercado de trabajo de Uruguay con la ECH 2022 utilizando el paquete metaSurvey y el paquete ech.</p>
<p>En capítulos posteriores se presentan conceptos claves de la meta-programación y se muestra cómo se utiliza la meta-programación en el paquete metaSurvey. Luego se presentan conceptos básicos de muestreo sobre los estimadores bajo el contexto de Inferencia en Poblaciones finitas, para luego mostrar cómo es crucial tener en cuenta el diseño de la encuesta para la construcción de indicadores y evaluar su incertidumbre, otro de los puntos fuertes del paquete metaSurvey. Por último, se muestra una aplicación del uso cotidiano del paquete, donde pueden verse ejemplos de cómo construir nuestras propias recetas y/o también consultar recetas ya construidas por otros usuarios</p>
</section>
<section id="mercado-de-trabajo-ech-vs-metasurvey" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="mercado-de-trabajo-ech-vs-metasurvey"><span class="header-section-number">1.2</span> Mercado de Trabajo {ech} vs {metaSurvey}</h2>
</section>
</section>
<section id="sec-Chapter2" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Metaprogramación</h1>
<p>En este capitulo se introducen los conceptos de Metaprogramación en R y se presentan las funciones básicas para la manipulación de expresiones y funciones así como también haciendo un breve mención sobre la aplicación en <strong>metaSurvey</strong>.</p>
<section id="principios-básicos" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="principios-básicos"><span class="header-section-number">2.1</span> Principios básicos</h2>
<p>Dentro de la programación existen diferentes paradigmas de programación, entre ellos se encuentra la programación orientada objetos (OOP), la programación funcional, programación lógica entre otras. En R, el paradigma predominante es la programación orientada a objetos, sin embargo, R también permite la programación funcional y la programación lógica, la facilidad o aplicación depede del contexto y la utilización de ciertas librerias. La metaprogramación es una técnica que se puede aplicar en cualquier paradigma de programación, sin embargo, en R la metaprogramación se aplica principalmente en la programación funcional.</p>
<p>La metaprogramación es una técnica que permite que el código pueda ser manipulado como datos. En R, el código se representa como una expresión. Una expresión es una estructura de datos que representa una instrucción o una parte de una instrucción. Por ejemplo, la expresión <code>x &lt;- 1</code> representa la instrucción de asignar el valor 1 a la variable <code>x</code>. La expresión <code>x + 1</code> representa la instrucción de sumar 1 al valor de la variable <code>x</code>. La expresión <code>x &lt;- 1; x + 1</code> representa la instrucción de asignar el valor 1 a la variable <code>x</code> y luego sumar 1 al valor de la variable <code>x</code>. Una expresión puede ser tan simple como una variable o tan compleja como una función anónima (o también conocida como función lambda).</p>
<p>En R, el código es un tipo de dato más. Esto permite que el código pueda ser manipulado como cualquier otro tipo de dato. Por ejemplo, se puede asignar código a una variable, pasar código como argumento a una función, o devolver código como resultado de una función. Manipular al código como datos es lo que se conoce como metaprogramación.</p>
<p>Para entender la metaprogramación es necesario entender los siguientes conceptos:</p>
<section id="el-código-cmo-datos" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="el-código-cmo-datos"><span class="header-section-number">2.1.1</span> El código cmo datos</h3>
<p>Dentro de este paradigma, no vamos a operar con un conjunto de datos rectangular sino que vamos a operar con los argumentos de una función (<strong>formals</strong>), el cuerpo de una función (<strong>body</strong>), el entorno de una función (<strong>environment</strong>), para generar de forma dínamica y flexible código para maipular, procesar y aplicar inferencia sobre encuestas por muestreo.</p>
</section>
<section id="el-código-como-expresiones" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="el-código-como-expresiones"><span class="header-section-number">2.1.2</span> El código como expresiones</h3>
<p>Al oprerar con expresiones es importante saber el detras de escenas al ejecutar código este concepto es conocido como <strong>Abstract syntax tree</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Cambiar el ejemplo por uno de metaSurvey haciendo referencia al engine.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>lobstr<span class="sc">::</span><span class="fu">ast</span>(<span class="fu">f</span>(a, <span class="st">"b"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; █─f </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ├─a </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; └─"b"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="el-código-puede-generar-código" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="el-código-puede-generar-código"><span class="header-section-number">2.1.3</span> El código puede generar código</h3>
</section>
<section id="el-código-puede-ser-evaluado" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="el-código-puede-ser-evaluado"><span class="header-section-number">2.1.4</span> El código puede ser evaluado</h3>
</section>
</section>
</section>
<section id="sec-Chapter3" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Muestreo</h1>
</section>
<section id="sec-Chapter3" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Metodología de varianzas</h1>
</section>
<section id="sec-Chapter4" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Desarollo del paquete</h1>
</section>
<section id="sec-Chapter4" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Infraestructura</h1>
<ul>
<li>Infra</li>
<li>Docker</li>
<li>Kubernetes</li>
<li>Tests</li>
<li>Envío a CRAN</li>
</ul>
</section>
<section id="sec-Chapter5" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Aplicación</h1>
<ul>
<li>Mostrar Series Históricas</li>
<li>Aplicación ANII</li>
<li>Compartir recetas</li>
</ul>
</section>
<section id="sec-Chapter5" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conclusiones y trabajo a futuro</h1>
<ul>
<li>Mostrar Series Históricas</li>
<li>Aplicación ANII</li>
<li>Compartir recetas</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-ech" class="csl-entry" role="listitem">
Mathieu, G., &amp; Detomasi, R. (2020). <em>Ech: Caja de herramientas para procesar la encuesta continua de hogares</em>. <a href="https://github.com/calcita/ech">https://github.com/calcita/ech</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Appendices/AppendixA.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Soy un apaendice</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>